<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëŒ€ì „ì¥ëŒ€ì¤‘í•™êµ ì—…ë¬´ ì•ˆë‚´</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 50%, #bbf7d0 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.9);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .modal-glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.8);
        }
        .calendar-day {
            min-height: 80px;
            transition: all 0.3s ease;
        }
        .calendar-day:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        .week-day {
            min-height: 120px;
        }
        .memo-item {
            transition: transform 0.2s ease;
        }
        .memo-item:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="min-h-screen p-4">
    <div class="max-w-7xl mx-auto">
        <!-- í—¤ë” -->
        <div class="glass-effect rounded-2xl p-6 mb-6 shadow-lg">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-4">
                    <!-- í•™êµ ë¡œê³  SVG -->
                    <div class="w-16 h-16 bg-green-600 rounded-full flex items-center justify-center shadow-lg">
                        <svg class="w-10 h-10 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z"/>
                        </svg>
                    </div>
                    <h1 class="text-3xl font-bold text-green-800">ëŒ€ì „ì¥ëŒ€ì¤‘í•™êµ ì›”ê°„/ì£¼ê°„ ì—…ë¬´ ê³„íš</h1>
                </div>
                <div class="flex gap-2">
                    <button id="monthViewBtn" class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium">ì›”ê°„ ë³´ê¸°</button>
                    <button id="weekViewBtn" class="px-6 py-2 bg-white text-green-600 rounded-lg hover:bg-green-50 transition-colors font-medium border border-green-600">ì£¼ê°„ ë³´ê¸°</button>
                </div>
            </div>
        </div>

        <!-- ì œì¶œì„ë°• & í€µë©”ëª¨ì¡´ -->
        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <!-- ì œì¶œì„ë°• -->
            <div class="glass-effect rounded-2xl p-6 shadow-lg">
                <h2 class="text-xl font-bold text-green-800 mb-4 flex items-center">
                    <span class="mr-2">âš ï¸</span>ì œì¶œì„ë°•
                </h2>
                <div id="urgentTasks" class="space-y-3">
                    <!-- ìº˜ë¦°ë”ì—ì„œ ì œì¶œ ì„ë°• ì•ŒëŒì´ ì„¤ì •ëœ ì¼ì •ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- í€µë©”ëª¨ì¡´ -->
            <div class="glass-effect rounded-2xl p-6 shadow-lg">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-green-800 flex items-center">
                        <span class="mr-2">ğŸ“</span>í€µ ë©”ëª¨ì¡´
                    </h2>
                    <button id="addMemoBtn" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm">ë©”ëª¨ ì¶”ê°€</button>
                </div>
                <div id="memoList" class="space-y-2 max-h-40 overflow-y-auto">
                    <!-- ë©”ëª¨ í•­ëª©ë“¤ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <!-- ì›”ë³„/ì£¼ë³„ ì¼ì • -->
        <div class="glass-effect rounded-2xl p-6 mb-6 shadow-lg">
            <div id="calendarHeader" class="flex justify-between items-center mb-6">
                <button id="prevBtn" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">â—€ ì´ì „</button>
                <h2 id="calendarTitle" class="text-2xl font-bold text-green-800">2025ë…„ 1ì›”</h2>
                <button id="nextBtn" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">ë‹¤ìŒ â–¶</button>
            </div>
            
            <!-- ì›”ê°„ ë‹¬ë ¥ -->
            <div id="monthView" class="calendar-view">
                <div class="grid grid-cols-7 gap-1 mb-2">
                    <div class="text-center font-bold text-red-600 p-2">ì¼</div>
                    <div class="text-center font-bold text-green-800 p-2">ì›”</div>
                    <div class="text-center font-bold text-green-800 p-2">í™”</div>
                    <div class="text-center font-bold text-green-800 p-2">ìˆ˜</div>
                    <div class="text-center font-bold text-green-800 p-2">ëª©</div>
                    <div class="text-center font-bold text-green-800 p-2">ê¸ˆ</div>
                    <div class="text-center font-bold text-blue-600 p-2">í† </div>
                </div>
                <div id="monthCalendar" class="grid grid-cols-7 gap-1">
                    <!-- ë‹¬ë ¥ ë‚ ì§œë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ì£¼ê°„ ë‹¬ë ¥ -->
            <div id="weekView" class="calendar-view hidden">
                <div class="grid grid-cols-7 gap-2">
                    <div class="text-center font-bold text-red-600 p-2">ì¼</div>
                    <div class="text-center font-bold text-green-800 p-2">ì›”</div>
                    <div class="text-center font-bold text-green-800 p-2">í™”</div>
                    <div class="text-center font-bold text-green-800 p-2">ìˆ˜</div>
                    <div class="text-center font-bold text-green-800 p-2">ëª©</div>
                    <div class="text-center font-bold text-green-800 p-2">ê¸ˆ</div>
                    <div class="text-center font-bold text-blue-600 p-2">í† </div>
                </div>
                <div id="weekCalendar" class="grid grid-cols-7 gap-2 mt-2">
                    <!-- ì£¼ê°„ ë‹¬ë ¥ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <button id="addEventBtn" class="mt-6 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium w-full">ì¼ì • ì¶”ê°€</button>
        </div>

        <!-- ìë£Œ ì§‘ê³„ -->
        <div class="glass-effect rounded-2xl p-6 shadow-lg">
            <h2 class="text-xl font-bold text-green-800 mb-4 flex items-center">
                <span class="mr-2">ğŸ“Š</span>ìë£Œ ì§‘ê³„
            </h2>
            <div id="uploadArea" class="border-2 border-dashed border-green-400 rounded-lg text-center mb-4">
                <input type="file" id="imageUpload" accept="image/*" class="hidden">
                <div id="uploadButton" class="p-8">
                    <button onclick="document.getElementById('imageUpload').click()" class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium">
                        ğŸ“· ì´ë¯¸ì§€ ì—…ë¡œë“œ
                    </button>
                    <p class="text-green-700 mt-2">í™”ë©´ ìº¡ì³ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
                </div>
                <div id="uploadedImages" class="p-4 hidden w-full">
                    <!-- ì—…ë¡œë“œëœ ì´ë¯¸ì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
                <div class="text-right text-green-700 text-sm mt-4 px-4 pb-4">
                    ìµœì¢… ìˆ˜ì •: <span id="lastModified">-</span>
                </div>
            </div>
        </div>
    </div>



    <!-- ì¼ì • ì¶”ê°€ ëª¨ë‹¬ -->
    <div id="eventModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="modal-glass rounded-2xl p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto shadow-2xl">
            <h3 class="text-xl font-bold text-green-800 mb-4">ì¼ì • ì¶”ê°€</h3>
            <form id="eventForm">
                <div class="mb-4">
                    <label class="block text-green-800 font-medium mb-2">ë¶€ì„œ</label>
                    <select id="eventDepartment" class="w-full p-3 border border-green-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" required>
                        <option value="">ë¶€ì„œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="êµë¬´ìš´ì˜ë¶€">êµë¬´ìš´ì˜ë¶€</option>
                        <option value="êµìœ¡ì—°êµ¬ë¶€">êµìœ¡ì—°êµ¬ë¶€</option>
                        <option value="ìƒí™œì•ˆì „ë¶€">ìƒí™œì•ˆì „ë¶€</option>
                        <option value="êµìœ¡ì •ë³´íƒêµ¬ë¶€">êµìœ¡ì •ë³´íƒêµ¬ë¶€</option>
                        <option value="ì²´ìœ¡ë³´ê±´ë¶€">ì²´ìœ¡ë³´ê±´ë¶€</option>
                        <option value="ì§„ë¡œì§„í•™ìƒë‹´ë¶€">ì§„ë¡œì§„í•™ìƒë‹´ë¶€</option>
                        <option value="ì§€ì—­ì‚¬íšŒí™˜ê²½ë¶€">ì§€ì—­ì‚¬íšŒí™˜ê²½ë¶€</option>
                        <option value="í•™ë ¥ì‹ ì¥ë°©ê³¼í›„í•™êµë¶€">í•™ë ¥ì‹ ì¥ë°©ê³¼í›„í•™êµë¶€</option>
                        <option value="1í•™ë…„ë¶€">1í•™ë…„ë¶€</option>
                        <option value="2í•™ë…„ë¶€">2í•™ë…„ë¶€</option>
                        <option value="3í•™ë…„ë¶€">3í•™ë…„ë¶€</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-green-800 font-medium mb-2">ì œëª©</label>
                    <input type="text" id="eventTitle" class="w-full p-3 border border-green-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-green-800 font-medium mb-2">ì„¤ëª…</label>
                    <textarea id="eventDescription" class="w-full p-3 border border-green-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 h-20"></textarea>
                </div>
                <div class="mb-4">
                    <label class="block text-green-800 font-medium mb-2">ì‹œê°„</label>
                    <input type="time" id="eventTime" class="w-full p-3 border border-green-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                </div>
                <div class="mb-4">
                    <label class="block text-green-800 font-medium mb-2">ì¥ì†Œ</label>
                    <input type="text" id="eventLocation" class="w-full p-3 border border-green-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                </div>
                <div class="mb-4">
                    <label class="block text-green-800 font-medium mb-2">ìœ í˜•</label>
                    <select id="eventType" class="w-full p-3 border border-green-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        <option value="íšŒì˜">íšŒì˜</option>
                        <option value="ì œì¶œ">ì œì¶œ</option>
                        <option value="í•™ì‚¬ì¼ì •">í•™ì‚¬ì¼ì •</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-green-800 font-medium mb-2">ì²¨ë¶€íŒŒì¼</label>
                    <div id="fileInputs">
                        <input type="file" class="w-full p-2 border border-green-300 rounded-lg mb-2">
                    </div>
                    <button type="button" id="addFileBtn" class="text-green-600 hover:text-green-800 text-sm">+ íŒŒì¼ ì¶”ê°€</button>
                </div>
                <div class="mb-4">
                    <label class="flex items-center">
                        <input type="checkbox" id="urgentAlert" class="mr-2">
                        <span class="text-green-800">ì œì¶œ ì„ë°• ì•ŒëŒ í‘œì‹œ</span>
                    </label>
                </div>
                <div class="flex gap-3">
                    <button type="submit" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">ì¶”ê°€</button>
                    <button type="button" id="cancelEventBtn" class="flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ë©”ëª¨ ì¶”ê°€ ëª¨ë‹¬ -->
    <div id="memoModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="modal-glass rounded-2xl p-6 max-w-md w-full mx-4 shadow-2xl">
            <h3 class="text-xl font-bold text-green-800 mb-4">ë©”ëª¨ ì¶”ê°€</h3>
            <form id="memoForm">
                <div class="mb-4">
                    <label class="block text-green-800 font-medium mb-2">ë¶€ì„œ</label>
                    <select id="memoDepartment" class="w-full p-3 border border-green-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" required>
                        <option value="">ë¶€ì„œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="êµë¬´ìš´ì˜ë¶€">êµë¬´ìš´ì˜ë¶€</option>
                        <option value="êµìœ¡ì—°êµ¬ë¶€">êµìœ¡ì—°êµ¬ë¶€</option>
                        <option value="ìƒí™œì•ˆì „ë¶€">ìƒí™œì•ˆì „ë¶€</option>
                        <option value="êµìœ¡ì •ë³´íƒêµ¬ë¶€">êµìœ¡ì •ë³´íƒêµ¬ë¶€</option>
                        <option value="ì²´ìœ¡ë³´ê±´ë¶€">ì²´ìœ¡ë³´ê±´ë¶€</option>
                        <option value="ì§„ë¡œì§„í•™ìƒë‹´ë¶€">ì§„ë¡œì§„í•™ìƒë‹´ë¶€</option>
                        <option value="ì§€ì—­ì‚¬íšŒí™˜ê²½ë¶€">ì§€ì—­ì‚¬íšŒí™˜ê²½ë¶€</option>
                        <option value="í•™ë ¥ì‹ ì¥ë°©ê³¼í›„í•™êµë¶€">í•™ë ¥ì‹ ì¥ë°©ê³¼í›„í•™êµë¶€</option>
                        <option value="1í•™ë…„ë¶€">1í•™ë…„ë¶€</option>
                        <option value="2í•™ë…„ë¶€">2í•™ë…„ë¶€</option>
                        <option value="3í•™ë…„ë¶€">3í•™ë…„ë¶€</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-green-800 font-medium mb-2">ë©”ëª¨ ë‚´ìš©</label>
                    <textarea id="memoContent" class="w-full p-3 border border-green-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 h-24" required></textarea>
                </div>
                <div class="mb-4">
                    <label class="block text-green-800 font-medium mb-2">ì‚­ì œ ë¹„ë°€ë²ˆí˜¸ (4ìë¦¬ ìˆ«ì)</label>
                    <input type="password" id="memoPassword" class="w-full p-3 border border-green-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" pattern="[0-9]{4}" maxlength="4" required>
                </div>
                <div class="flex gap-3">
                    <button type="submit" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">ì¶”ê°€</button>
                    <button type="button" id="cancelMemoBtn" class="flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ë©”ëª¨ ìƒì„¸ ëª¨ë‹¬ -->
    <div id="memoDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="modal-glass rounded-2xl p-6 max-w-md w-full mx-4 shadow-2xl">
            <h3 class="text-xl font-bold text-green-800 mb-4">ë©”ëª¨ ìƒì„¸</h3>
            <div id="memoDetailContent" class="mb-4 p-3 bg-white bg-opacity-50 rounded-lg min-h-[100px]"></div>
            <div class="flex gap-3">
                <button id="deleteMemoBtn" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">ì‚­ì œ</button>
                <button id="closeMemoDetailBtn" class="flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <!-- ì¼ì • ìƒì„¸ ëª¨ë‹¬ -->
    <div id="eventDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="modal-glass rounded-2xl p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto shadow-2xl">
            <h3 class="text-xl font-bold text-green-800 mb-4">ì¼ì • ìƒì„¸</h3>
            <div id="eventDetailContent" class="mb-4 space-y-3">
                <!-- ì¼ì • ìƒì„¸ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            <div class="flex gap-3">
                <button id="editEventBtn" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">í¸ì§‘</button>
                <button id="deleteEventBtn" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">ì‚­ì œ</button>
                <button id="closeEventDetailBtn" class="flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <!-- ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ëª¨ë‹¬ -->
    <div id="passwordModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="modal-glass rounded-2xl p-6 max-w-sm w-full mx-4 shadow-2xl">
            <h3 class="text-xl font-bold text-green-800 mb-4">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</h3>
            <form id="passwordForm">
                <div class="mb-4">
                    <label class="block text-green-800 font-medium mb-2">ì‚­ì œ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥</label>
                    <input type="password" id="deletePassword" class="w-full p-3 border border-green-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" pattern="[0-9]{4}" maxlength="4" required>
                </div>
                <div class="flex gap-3">
                    <button type="submit" class="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">ì‚­ì œ</button>
                    <button type="button" id="cancelPasswordBtn" class="flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentDate = new Date();
        let currentView = 'month';
        let selectedDate = null;
        let events = {};
        let memos = [];
        let currentMemoIndex = null;
        let currentEventId = null;
        let isEditingEvent = false;

        // ê³µíœ´ì¼ ë°ì´í„° (2025ë…„ ê¸°ì¤€ - ëŒ€ì²´ê³µíœ´ì¼ í¬í•¨)
        const holidays = {
            '2025': {
                '0-1': 'ì‹ ì •',
                '0-27': 'ì„¤ë‚  ì—°íœ´',
                '0-28': 'ì„¤ë‚ ',
                '0-29': 'ì„¤ë‚  ì—°íœ´',
                '2-1': 'ì‚¼ì¼ì ˆ',
                '2-3': 'ì‚¼ì¼ì ˆ ëŒ€ì²´ê³µíœ´ì¼',
                '4-5': 'ì–´ë¦°ì´ë‚ ',
                '4-6': 'ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ',
                '5-6': 'í˜„ì¶©ì¼',
                '7-15': 'ê´‘ë³µì ˆ',
                '9-5': 'ì¶”ì„ ì—°íœ´',
                '9-6': 'ì¶”ì„',
                '9-7': 'ì¶”ì„ ì—°íœ´',
                '9-8': 'ì¶”ì„ ëŒ€ì²´ê³µíœ´ì¼',
                '9-3': 'ê°œì²œì ˆ',
                '9-9': 'í•œê¸€ë‚ ',
                '11-25': 'ì„±íƒ„ì ˆ'
            }
        };

        // ê³µíœ´ì¼ í™•ì¸ í•¨ìˆ˜
        function checkHoliday(date) {
            const year = date.getFullYear().toString();
            const month = date.getMonth();
            const day = date.getDate();
            const key = `${month}-${day}`;
            
            return holidays[year] && holidays[year][key];
        }



        // ë°ì´í„° ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° í•¨ìˆ˜
        function saveData() {
            const uploadedImages = document.getElementById('uploadedImages');
            const imageElement = uploadedImages.querySelector('img');
            const uploadedImageData = imageElement ? imageElement.src : null;
            
            const data = {
                events: events,
                memos: memos,
                uploadedImage: uploadedImageData,
                lastModified: new Date().toISOString()
            };
            localStorage.setItem('schoolScheduleData', JSON.stringify(data));
        }

        function loadData() {
            const savedData = localStorage.getItem('schoolScheduleData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    events = data.events || {};
                    memos = data.memos || [];
                    
                    // ë©”ëª¨ ëª©ë¡ ì—…ë°ì´íŠ¸
                    updateMemoList();
                    
                    // ì—…ë¡œë“œëœ ì´ë¯¸ì§€ ë³µì›
                    if (data.uploadedImage) {
                        const uploadedImages = document.getElementById('uploadedImages');
                        const uploadButton = document.getElementById('uploadButton');
                        
                        uploadButton.classList.add('hidden');
                        uploadedImages.classList.remove('hidden');
                        
                        const imageDiv = document.createElement('div');
                        imageDiv.className = 'relative group cursor-pointer w-full';
                        imageDiv.innerHTML = `
                            <img src="${data.uploadedImage}" class="w-full h-auto rounded-lg shadow-md">
                            <div class="absolute inset-0 bg-black bg-opacity-50 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center gap-2">
                                <button onclick="editImage(this)" class="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm">ìˆ˜ì •</button>
                                <button onclick="deleteImage(this)" class="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors text-sm">ì‚­ì œ</button>
                            </div>
                        `;
                        uploadedImages.appendChild(imageDiv);
                    }
                    
                    // ë§ˆì§€ë§‰ ìˆ˜ì • ì‹œê°„ í‘œì‹œ
                    if (data.lastModified) {
                        const lastModified = new Date(data.lastModified);
                        document.getElementById('lastModified').textContent = lastModified.toLocaleString('ko-KR');
                    }
                } catch (error) {
                    console.error('ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', error);
                }
            }
        }



        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            loadData(); // ì €ì¥ëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
            updateCalendar();
            updateUrgentTasks();
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            setupEventListeners();
        });

        function setupEventListeners() {
            // ë·° ì „í™˜ ë²„íŠ¼
            document.getElementById('monthViewBtn').addEventListener('click', () => switchView('month'));
            document.getElementById('weekViewBtn').addEventListener('click', () => switchView('week'));
            
            // ë‹¬ë ¥ ë„¤ë¹„ê²Œì´ì…˜
            document.getElementById('prevBtn').addEventListener('click', () => navigateCalendar(-1));
            document.getElementById('nextBtn').addEventListener('click', () => navigateCalendar(1));
            
            // ì¼ì • ì¶”ê°€
            document.getElementById('addEventBtn').addEventListener('click', openEventModal);
            document.getElementById('eventForm').addEventListener('submit', addEvent);
            document.getElementById('cancelEventBtn').addEventListener('click', closeEventModal);
            
            // íŒŒì¼ ì¶”ê°€
            document.getElementById('addFileBtn').addEventListener('click', addFileInput);
            
            // ë©”ëª¨ ê´€ë ¨
            document.getElementById('addMemoBtn').addEventListener('click', openMemoModal);
            document.getElementById('memoForm').addEventListener('submit', addMemo);
            document.getElementById('cancelMemoBtn').addEventListener('click', closeMemoModal);
            document.getElementById('closeMemoDetailBtn').addEventListener('click', closeMemoDetailModal);
            document.getElementById('deleteMemoBtn').addEventListener('click', openPasswordModal);
            document.getElementById('passwordForm').addEventListener('submit', deleteMemo);
            document.getElementById('cancelPasswordBtn').addEventListener('click', closePasswordModal);
            
            // ì¼ì • ìƒì„¸ ê´€ë ¨
            document.getElementById('closeEventDetailBtn').addEventListener('click', closeEventDetailModal);
            document.getElementById('editEventBtn').addEventListener('click', editEvent);
            document.getElementById('deleteEventBtn').addEventListener('click', deleteEvent);
            
            // ì´ë¯¸ì§€ ì—…ë¡œë“œ
            document.getElementById('imageUpload').addEventListener('change', handleImageUpload);
        }



        function switchView(view) {
            currentView = view;
            const monthBtn = document.getElementById('monthViewBtn');
            const weekBtn = document.getElementById('weekViewBtn');
            const monthView = document.getElementById('monthView');
            const weekView = document.getElementById('weekView');
            
            if (view === 'month') {
                monthBtn.className = 'px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium';
                weekBtn.className = 'px-6 py-2 bg-white text-green-600 rounded-lg hover:bg-green-50 transition-colors font-medium border border-green-600';
                monthView.classList.remove('hidden');
                weekView.classList.add('hidden');
            } else {
                weekBtn.className = 'px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium';
                monthBtn.className = 'px-6 py-2 bg-white text-green-600 rounded-lg hover:bg-green-50 transition-colors font-medium border border-green-600';
                weekView.classList.remove('hidden');
                monthView.classList.add('hidden');
            }
            
            updateCalendar();
        }

        function navigateCalendar(direction) {
            if (currentView === 'month') {
                currentDate.setMonth(currentDate.getMonth() + direction);
            } else {
                currentDate.setDate(currentDate.getDate() + (direction * 7));
            }
            updateCalendar();
        }

        function updateCalendar() {
            if (currentView === 'month') {
                updateMonthCalendar();
            } else {
                updateWeekCalendar();
            }
        }

        function updateMonthCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            document.getElementById('calendarTitle').textContent = `${year}ë…„ ${month + 1}ì›”`;
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            const calendar = document.getElementById('monthCalendar');
            calendar.innerHTML = '';
            
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day border border-green-200 rounded-lg p-2 cursor-pointer';
                
                // ìš”ì¼ë³„ ìƒ‰ìƒ ì ìš©
                const dayOfWeek = date.getDay();
                const isHoliday = checkHoliday(date);
                
                if (date.getMonth() !== month) {
                    dayElement.classList.add('text-gray-400');
                } else if (isHoliday || dayOfWeek === 0) { // ê³µíœ´ì¼ ë˜ëŠ” ì¼ìš”ì¼
                    dayElement.classList.add('text-red-600');
                } else if (dayOfWeek === 6) { // í† ìš”ì¼
                    dayElement.classList.add('text-blue-600');
                }
                
                const dateKey = `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;
                const dayEvents = events[dateKey] || [];
                
                dayElement.innerHTML = `
                    <div class="font-medium">${date.getDate()}</div>
                    <div class="text-xs space-y-1 mt-1">
                        ${dayEvents.map(event => `
                            <div class="bg-green-200 text-green-800 px-1 py-0.5 rounded text-xs truncate cursor-pointer hover:bg-green-300" onclick="event.stopPropagation(); openEventDetail('${dateKey}', ${event.id})">
                                ${event.title}
                            </div>
                        `).join('')}
                    </div>
                `;
                
                dayElement.addEventListener('click', () => {
                    selectedDate = dateKey;
                    openEventModal();
                });
                
                calendar.appendChild(dayElement);
            }
        }

        function updateWeekCalendar() {
            const startOfWeek = new Date(currentDate);
            startOfWeek.setDate(currentDate.getDate() - currentDate.getDay());
            
            const endOfWeek = new Date(startOfWeek);
            endOfWeek.setDate(startOfWeek.getDate() + 6);
            
            // ì£¼ê°„ ì œëª© ìƒì„± - ì›”ì´ ê²¹ì¹˜ëŠ” ê²½ìš°ì™€ ì—°ë„ê°€ ë°”ë€ŒëŠ” ê²½ìš° ì²˜ë¦¬
            let weekTitle;
            if (startOfWeek.getFullYear() === endOfWeek.getFullYear() && startOfWeek.getMonth() === endOfWeek.getMonth()) {
                // ê°™ì€ ì—°ë„, ê°™ì€ ì›”ì¸ ê²½ìš°
                const weekNumber = Math.ceil((currentDate.getDate() + new Date(currentDate.getFullYear(), currentDate.getMonth(), 1).getDay()) / 7);
                weekTitle = `${startOfWeek.getFullYear()}ë…„ ${startOfWeek.getMonth() + 1}ì›” ${weekNumber}ì£¼`;
            } else if (startOfWeek.getFullYear() === endOfWeek.getFullYear()) {
                // ê°™ì€ ì—°ë„, ë‹¤ë¥¸ ì›”ì¸ ê²½ìš°
                const startWeekNumber = Math.ceil((startOfWeek.getDate() + new Date(startOfWeek.getFullYear(), startOfWeek.getMonth(), 1).getDay()) / 7);
                const endWeekNumber = Math.ceil((endOfWeek.getDate() + new Date(endOfWeek.getFullYear(), endOfWeek.getMonth(), 1).getDay()) / 7);
                weekTitle = `${startOfWeek.getFullYear()}ë…„ ${startOfWeek.getMonth() + 1}ì›” ${startWeekNumber}ì£¼~${endOfWeek.getMonth() + 1}ì›” ${endWeekNumber}ì£¼`;
            } else {
                // ì—°ë„ê°€ ë°”ë€ŒëŠ” ê²½ìš°
                const startWeekNumber = Math.ceil((startOfWeek.getDate() + new Date(startOfWeek.getFullYear(), startOfWeek.getMonth(), 1).getDay()) / 7);
                const endWeekNumber = Math.ceil((endOfWeek.getDate() + new Date(endOfWeek.getFullYear(), endOfWeek.getMonth(), 1).getDay()) / 7);
                weekTitle = `${startOfWeek.getFullYear()}ë…„ ${startOfWeek.getMonth() + 1}ì›” ${startWeekNumber}ì£¼~${endOfWeek.getFullYear()}ë…„ ${endOfWeek.getMonth() + 1}ì›” ${endWeekNumber}ì£¼`;
            }
            
            document.getElementById('calendarTitle').textContent = weekTitle;
            
            const calendar = document.getElementById('weekCalendar');
            calendar.innerHTML = '';
            
            for (let i = 0; i < 7; i++) {
                const date = new Date(startOfWeek);
                date.setDate(startOfWeek.getDate() + i);
                
                const dateKey = `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;
                const dayEvents = events[dateKey] || [];
                
                const dayElement = document.createElement('div');
                dayElement.className = 'week-day border border-green-200 rounded-lg p-3 cursor-pointer';
                
                // ìš”ì¼ë³„ ìƒ‰ìƒ ì ìš©
                const dayOfWeek = date.getDay();
                const isHoliday = checkHoliday(date);
                let dateColorClass = 'text-green-800';
                
                if (isHoliday || dayOfWeek === 0) { // ê³µíœ´ì¼ ë˜ëŠ” ì¼ìš”ì¼
                    dateColorClass = 'text-red-600';
                } else if (dayOfWeek === 6) { // í† ìš”ì¼
                    dateColorClass = 'text-blue-600';
                }
                
                dayElement.innerHTML = `
                    <div class="font-bold ${dateColorClass} mb-2">${date.getDate()}ì¼</div>
                    <div class="space-y-2">
                        ${dayEvents.map(event => `
                            <div class="bg-green-100 border-l-4 border-green-500 p-2 rounded cursor-pointer hover:bg-green-200" onclick="event.stopPropagation(); openEventDetail('${dateKey}', ${event.id})">
                                <div class="font-medium text-green-800">${event.title}</div>
                                <div class="text-xs text-green-600">${event.time || ''} ${event.location || ''}</div>
                                <div class="text-xs text-green-500">${event.type}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                dayElement.addEventListener('click', () => {
                    selectedDate = dateKey;
                    openEventModal();
                });
                
                calendar.appendChild(dayElement);
            }
            
            // ì œì¶œ ì„ë°• ì—…ë°ì´íŠ¸
            updateUrgentTasks();
        }

        function openEventModal() {
            const modalTitle = document.querySelector('#eventModal h3');
            modalTitle.textContent = isEditingEvent ? 'ì¼ì • í¸ì§‘' : 'ì¼ì • ì¶”ê°€';
            document.getElementById('eventModal').classList.remove('hidden');
            document.getElementById('eventModal').classList.add('flex');
        }

        function closeEventModal() {
            document.getElementById('eventModal').classList.add('hidden');
            document.getElementById('eventModal').classList.remove('flex');
            document.getElementById('eventForm').reset();
            selectedDate = null;
            isEditingEvent = false;
            currentEventId = null;
        }

        function addEvent(e) {
            e.preventDefault();
            
            const department = document.getElementById('eventDepartment').value;
            const title = document.getElementById('eventTitle').value;
            const description = document.getElementById('eventDescription').value;
            const time = document.getElementById('eventTime').value;
            const location = document.getElementById('eventLocation').value;
            const type = document.getElementById('eventType').value;
            const urgentAlert = document.getElementById('urgentAlert').checked;
            
            const eventDate = selectedDate || `${currentDate.getFullYear()}-${currentDate.getMonth()}-${currentDate.getDate()}`;
            
            if (isEditingEvent && currentEventId) {
                // í¸ì§‘ ëª¨ë“œ
                Object.keys(events).forEach(dateKey => {
                    const eventIndex = events[dateKey].findIndex(event => event.id === currentEventId);
                    if (eventIndex !== -1) {
                        events[dateKey][eventIndex] = {
                            title: `[${department}] ${title}`,
                            description,
                            time,
                            location,
                            type,
                            urgentAlert,
                            department,
                            id: currentEventId
                        };
                    }
                });
            } else {
                // ìƒˆ ì¼ì • ì¶”ê°€
                if (!events[eventDate]) {
                    events[eventDate] = [];
                }
                
                const newEvent = {
                    title: `[${department}] ${title}`,
                    description,
                    time,
                    location,
                    type,
                    urgentAlert,
                    department,
                    id: Date.now()
                };
                
                events[eventDate].push(newEvent);
            }
            
            updateCalendar();
            closeEventModal();
            updateLastModified();
            updateUrgentTasks();
            saveData(); // ë°ì´í„° ì €ì¥
        }

        function addFileInput() {
            const fileInputs = document.getElementById('fileInputs');
            const newInput = document.createElement('input');
            newInput.type = 'file';
            newInput.className = 'w-full p-2 border border-green-300 rounded-lg mb-2';
            fileInputs.appendChild(newInput);
        }

        function openMemoModal() {
            document.getElementById('memoModal').classList.remove('hidden');
            document.getElementById('memoModal').classList.add('flex');
        }

        function closeMemoModal() {
            document.getElementById('memoModal').classList.add('hidden');
            document.getElementById('memoModal').classList.remove('flex');
            document.getElementById('memoForm').reset();
        }

        function addMemo(e) {
            e.preventDefault();
            
            const department = document.getElementById('memoDepartment').value;
            const content = document.getElementById('memoContent').value;
            const password = document.getElementById('memoPassword').value;
            
            const newMemo = {
                content: `[${department}] ${content}`,
                password,
                department,
                id: Date.now(),
                date: new Date().toLocaleString('ko-KR')
            };
            
            memos.push(newMemo);
            updateMemoList();
            closeMemoModal();
            updateLastModified();
            saveData(); // ë°ì´í„° ì €ì¥
        }

        function updateMemoList() {
            const memoList = document.getElementById('memoList');
            memoList.innerHTML = memos.map((memo, index) => `
                <div class="memo-item bg-white bg-opacity-50 p-3 rounded-lg cursor-pointer hover:bg-opacity-70" onclick="openMemoDetail(${index})">
                    <div class="font-medium text-green-800 truncate">${memo.content.substring(0, 30)}${memo.content.length > 30 ? '...' : ''}</div>
                    <div class="text-xs text-green-600">${memo.date}</div>
                </div>
            `).join('');
        }

        function openMemoDetail(index) {
            currentMemoIndex = index;
            const memo = memos[index];
            document.getElementById('memoDetailContent').innerHTML = `
                <div class="whitespace-pre-wrap">${memo.content}</div>
                <div class="text-xs text-green-600 mt-2">ì‘ì„±ì¼: ${memo.date}</div>
            `;
            document.getElementById('memoDetailModal').classList.remove('hidden');
            document.getElementById('memoDetailModal').classList.add('flex');
        }

        function closeMemoDetailModal() {
            document.getElementById('memoDetailModal').classList.add('hidden');
            document.getElementById('memoDetailModal').classList.remove('flex');
            currentMemoIndex = null;
        }

        function openPasswordModal() {
            document.getElementById('passwordModal').classList.remove('hidden');
            document.getElementById('passwordModal').classList.add('flex');
        }

        function closePasswordModal() {
            document.getElementById('passwordModal').classList.add('hidden');
            document.getElementById('passwordModal').classList.remove('flex');
            document.getElementById('passwordForm').reset();
        }

        function deleteMemo(e) {
            e.preventDefault();
            
            const inputPassword = document.getElementById('deletePassword').value;
            const memo = memos[currentMemoIndex];
            
            if (inputPassword === memo.password) {
                memos.splice(currentMemoIndex, 1);
                updateMemoList();
                closeMemoDetailModal();
                closePasswordModal();
                updateLastModified();
                saveData(); // ë°ì´í„° ì €ì¥
            } else {
                alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            }
        }

        function updateUrgentTasks() {
            const urgentTasks = document.getElementById('urgentTasks');
            const today = new Date();
            today.setHours(0, 0, 0, 0); // ì‹œê°„ì„ 00:00:00ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ë‚ ì§œë§Œ ë¹„êµ
            const urgentList = [];
            
            // ëª¨ë“  ì´ë²¤íŠ¸ì—ì„œ ì œì¶œ ì„ë°• ì•ŒëŒì´ ì„¤ì •ëœ í•­ëª© ì°¾ê¸°
            Object.keys(events).forEach(dateKey => {
                const [year, month, day] = dateKey.split('-').map(Number);
                const eventDate = new Date(year, month, day);
                eventDate.setHours(0, 0, 0, 0); // ì‹œê°„ì„ 00:00:00ìœ¼ë¡œ ì„¤ì •
                const daysDiff = Math.ceil((eventDate - today) / (1000 * 60 * 60 * 24));
                
                events[dateKey].forEach(event => {
                    if (event.urgentAlert && daysDiff <= 3 && daysDiff >= 0) {
                        urgentList.push({
                            ...event,
                            daysLeft: daysDiff,
                            dateKey: dateKey
                        });
                    }
                });
            });
            
            // ë‚ ì§œìˆœìœ¼ë¡œ ì •ë ¬ (ê°€ì¥ ì„ë°•í•œ ìˆœì„œëŒ€ë¡œ)
            urgentList.sort((a, b) => a.daysLeft - b.daysLeft);
            
            if (urgentList.length === 0) {
                urgentTasks.innerHTML = '<div class="text-green-600 text-center py-4">í˜„ì¬ ì œì¶œ ì„ë°• í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
            } else {
                urgentTasks.innerHTML = urgentList.map(task => {
                    let urgencyClass = 'bg-yellow-100 border-yellow-500';
                    let textClass = 'text-yellow-800';
                    let dateTextClass = 'text-yellow-600';
                    
                    if (task.daysLeft === 0) {
                        urgencyClass = 'bg-red-100 border-red-500';
                        textClass = 'text-red-800';
                        dateTextClass = 'text-red-600';
                    } else if (task.daysLeft === 1) {
                        urgencyClass = 'bg-orange-100 border-orange-500';
                        textClass = 'text-orange-800';
                        dateTextClass = 'text-orange-600';
                    }
                    
                    return `
                        <div class="${urgencyClass} border-l-4 p-3 rounded cursor-pointer hover:bg-opacity-80" onclick="openEventDetail('${task.dateKey}', ${task.id})">
                            <p class="${textClass} font-medium">${task.title}</p>
                            <p class="${dateTextClass} text-sm">ë§ˆê°: ${task.daysLeft === 0 ? 'ì˜¤ëŠ˜' : task.daysLeft + 'ì¼ í›„'}</p>
                            ${task.time ? `<p class="${dateTextClass} text-xs">ì‹œê°„: ${task.time}</p>` : ''}
                            ${task.location ? `<p class="${dateTextClass} text-xs">ì¥ì†Œ: ${task.location}</p>` : ''}
                        </div>
                    `;
                }).join('');
            }
        }

        function handleImageUpload(e) {
            const file = e.target.files[0];
            const uploadedImages = document.getElementById('uploadedImages');
            const uploadButton = document.getElementById('uploadButton');
            
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // ê¸°ì¡´ ì´ë¯¸ì§€ê°€ ìˆë‹¤ë©´ ì œê±°
                    uploadedImages.innerHTML = '';
                    
                    // ë²„íŠ¼ ìˆ¨ê¸°ê³  ì´ë¯¸ì§€ ì˜ì—­ í‘œì‹œ
                    uploadButton.classList.add('hidden');
                    uploadedImages.classList.remove('hidden');
                    
                    const imageDiv = document.createElement('div');
                    imageDiv.className = 'relative group cursor-pointer w-full';
                    imageDiv.innerHTML = `
                        <img src="${e.target.result}" class="w-full h-auto rounded-lg shadow-md">
                        <div class="absolute inset-0 bg-black bg-opacity-50 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center gap-2">
                            <button onclick="editImage(this)" class="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm">ìˆ˜ì •</button>
                            <button onclick="deleteImage(this)" class="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors text-sm">ì‚­ì œ</button>
                        </div>
                    `;
                    uploadedImages.appendChild(imageDiv);
                    updateLastModified();
                    saveData(); // ë°ì´í„° ì €ì¥
                };
                reader.readAsDataURL(file);
            }
            
            // íŒŒì¼ ì…ë ¥ ì´ˆê¸°í™”
            e.target.value = '';
        }
        
        function editImage(button) {
            // ìƒˆ ì´ë¯¸ì§€ ì„ íƒì„ ìœ„í•œ íŒŒì¼ ì…ë ¥ ìƒì„±
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = 'image/*';
            fileInput.onchange = function(e) {
                const file = e.target.files[0];
                if (file && file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const imageDiv = button.closest('.group');
                        const img = imageDiv.querySelector('img');
                        img.src = e.target.result;
                        updateLastModified();
                        saveData(); // ë°ì´í„° ì €ì¥
                    };
                    reader.readAsDataURL(file);
                }
            };
            fileInput.click();
        }
        
        function deleteImage(button) {
            const uploadedImages = document.getElementById('uploadedImages');
            const uploadButton = document.getElementById('uploadButton');
            
            // ì´ë¯¸ì§€ ì œê±°
            uploadedImages.innerHTML = '';
            uploadedImages.classList.add('hidden');
            uploadButton.classList.remove('hidden');
            updateLastModified();
            saveData(); // ë°ì´í„° ì €ì¥
        }

        function openEventDetail(dateKey, eventId) {
            const event = events[dateKey].find(e => e.id === eventId);
            if (!event) return;
            
            currentEventId = eventId;
            selectedDate = dateKey;
            
            document.getElementById('eventDetailContent').innerHTML = `
                <div class="bg-white bg-opacity-50 p-3 rounded-lg">
                    <div class="font-bold text-green-800 text-lg mb-2">${event.title}</div>
                    ${event.description ? `<div class="text-green-700 mb-2"><strong>ì„¤ëª…:</strong> ${event.description}</div>` : ''}
                    ${event.time ? `<div class="text-green-700 mb-2"><strong>ì‹œê°„:</strong> ${event.time}</div>` : ''}
                    ${event.location ? `<div class="text-green-700 mb-2"><strong>ì¥ì†Œ:</strong> ${event.location}</div>` : ''}
                    <div class="text-green-700 mb-2"><strong>ìœ í˜•:</strong> ${event.type}</div>
                    <div class="text-green-700 mb-2"><strong>ë¶€ì„œ:</strong> ${event.department}</div>
                    ${event.urgentAlert ? '<div class="text-red-600 text-sm">âš ï¸ ì œì¶œ ì„ë°• ì•ŒëŒ ì„¤ì •ë¨</div>' : ''}
                </div>
            `;
            
            document.getElementById('eventDetailModal').classList.remove('hidden');
            document.getElementById('eventDetailModal').classList.add('flex');
        }
        
        function closeEventDetailModal() {
            document.getElementById('eventDetailModal').classList.add('hidden');
            document.getElementById('eventDetailModal').classList.remove('flex');
            currentEventId = null;
            selectedDate = null;
        }
        
        function editEvent() {
            if (!currentEventId || !selectedDate) return;
            
            const event = events[selectedDate].find(e => e.id === currentEventId);
            if (!event) return;
            
            // í¸ì§‘ ëª¨ë“œ ì„¤ì •
            isEditingEvent = true;
            
            // í¼ì— ê¸°ì¡´ ë°ì´í„° ì±„ìš°ê¸°
            document.getElementById('eventDepartment').value = event.department;
            document.getElementById('eventTitle').value = event.title.replace(`[${event.department}] `, '');
            document.getElementById('eventDescription').value = event.description || '';
            document.getElementById('eventTime').value = event.time || '';
            document.getElementById('eventLocation').value = event.location || '';
            document.getElementById('eventType').value = event.type;
            document.getElementById('urgentAlert').checked = event.urgentAlert;
            
            // ìƒì„¸ ëª¨ë‹¬ ë‹«ê³  í¸ì§‘ ëª¨ë‹¬ ì—´ê¸°
            closeEventDetailModal();
            openEventModal();
        }
        
        function deleteEvent() {
            if (!currentEventId || !selectedDate) {
                console.error('ì‚­ì œ ì˜¤ë¥˜: currentEventId ë˜ëŠ” selectedDateê°€ ì—†ìŠµë‹ˆë‹¤.', { currentEventId, selectedDate });
                alert('ì‚­ì œí•  ì¼ì •ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (confirm('ì´ ì¼ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                console.log('ì‚­ì œ ì‹œì‘:', { currentEventId, selectedDate, events: Object.keys(events) });
                
                // í•´ë‹¹ ë‚ ì§œì˜ ì¼ì • ë°°ì—´ì—ì„œ í•´ë‹¹ IDë¥¼ ê°€ì§„ ì¼ì • ì°¾ê¸°
                if (events[selectedDate]) {
                    const eventIndex = events[selectedDate].findIndex(e => e.id === currentEventId);
                    console.log('ì°¾ì€ ì´ë²¤íŠ¸ ì¸ë±ìŠ¤:', eventIndex);
                    
                    if (eventIndex !== -1) {
                        // ì¼ì • ì‚­ì œ
                        const deletedEvent = events[selectedDate].splice(eventIndex, 1)[0];
                        console.log('ì‚­ì œëœ ì¼ì •:', deletedEvent);
                        
                        // í•´ë‹¹ ë‚ ì§œì— ì¼ì •ì´ ì—†ìœ¼ë©´ ë°°ì—´ ìì²´ë¥¼ ì‚­ì œ
                        if (events[selectedDate].length === 0) {
                            delete events[selectedDate];
                            console.log('ë¹ˆ ë‚ ì§œ ë°°ì—´ ì‚­ì œ');
                        }
                        
                        // UI ì—…ë°ì´íŠ¸
                        updateCalendar();
                        updateUrgentTasks();
                        updateLastModified();
                        saveData();
                        
                        // ëª¨ë‹¬ ë‹«ê¸°
                        closeEventDetailModal();
                        
                        alert('ì¼ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                    } else {
                        console.error('ì¼ì •ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                        alert('ì¼ì •ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                } else {
                    console.error('í•´ë‹¹ ë‚ ì§œì— ì¼ì •ì´ ì—†ìŒ');
                    alert('í•´ë‹¹ ë‚ ì§œì— ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.');
                }
            }
        }

        function updateLastModified() {
            const now = new Date();
            document.getElementById('lastModified').textContent = now.toLocaleString('ko-KR');
        }
    </script>
</body>
</html>
